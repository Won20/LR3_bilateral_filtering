# LR3_bilateral_filtering
https://colab.research.google.com/drive/1br7r75FdwDMNslucqNElkJmQ5F84wJEZ?usp=sharing

# Задача:
Учитывая размер изображения M × N, реализуйте и примените версию CUDA 9-точечного двустороннего фильтра и сохраните результат в выходное изображение. Пропущенные значения в граничных строках и столбцах необходимо брать из ближайших пикселей.
- Входные данные: входное изображение в градациях серого в формате BMP, σ values;

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/92739b49-650d-45f0-9ad8-4a1919aa7287)


- Выходные данные:
- -время обработки изображения с помощью процессора;
- -время обработки изображения с использованием графического процессора;
- -полученные изображения в формате BMP.

# Реализация:
Основные формулы, использованные в работе
![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/691f9e3a-44f0-4abe-aaf1-d00758b35498) - функция, вычисляющая новую интенсивность без нормализации клэффициентов, где

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/2c7cf626-b9e4-446e-af76-142b930d0411)

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/299d0d90-f030-4923-9627-3bb5446d1ed3) - коэффициент, зависящий от расстояния до центрального пикселя, где

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/a16f75a9-9eaf-4e18-8db0-f9136df118fe)

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/1134ff43-9f83-4af7-ac16-1d327712a124) - нормирующая константа для предотвращения увеличения интенсивности 

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/45e43093-cc2c-4c1b-81b7-1a6caf814132) - новое значение интенсивности пикселей

Идея:
- Каждый пиксель заменяется средневзвешенным значением его соседей.
- Каждый сосед "взвешивается" с помощью пространственного компонента, который смазывает удаленные пиксели и компонента диапазона, который смазывает пиксели с разной интенсивностью.
- Комбинация обоих компонентов гарантирует, что в конечный результат будут вносить вклад только близкие похожие пиксели.


# Результаты:
CPU 800 на 1200: 

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/5c935239-2aa7-4c90-b051-73fefcfb2a69)


GPU 800 на 1200: 
![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/9fdd55e6-fa67-4b51-8d24-29751512d623)

В таблицах представлено время выполнения и ускорение (одной и той же картинки в различных разрешениях, при одинаковых значениях сигма):

![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/2dbe9d7a-af13-46b0-9ea9-6fa6dbd5764f) 
![image](https://github.com/Won20/LR3_bilateral_filtering/assets/102918065/80dc054d-9055-4697-8c13-08daede921a3)

Работа была выполнена на языке Python, для расспаралеливания использовалась библиотека PyCuda. Выбор данной библиотеки был сделан для работы с текстурами.
Даже с учетом небольшой энергозатратности на выполнение данной операции, есть заметный прирост производительности.
Результаты вычислений визуально схожи.


